# コスト試算・管理可能会社数

## 📊 管理可能な会社数

### 現在の実装状況

**制限なし（実質的には無制限）**

- データベースレベルでの制限はありません
- プラン（FREE/PRO/BUSINESS）による制限も実装されていません
- 1ユーザーあたり、理論上は無制限に会社を管理可能

### 推奨される運用規模

| 規模 | 会社数 | データ量 | 推奨プラン |
|------|--------|----------|-----------|
| 小規模 | 1-10社 | 10,000件/月以下 | FREE/PRO |
| 中規模 | 11-50社 | 50,000件/月以下 | PRO |
| 大規模 | 51-200社 | 200,000件/月以下 | BUSINESS |
| エンタープライズ | 200社以上 | 200,000件/月以上 | カスタム |

### パフォーマンス考慮事項

- **データベースクエリ**: 会社数が増えると、フィルタリング処理が若干重くなる可能性
- **UI表示**: 100社以上の場合、サイドバーのスクロールが必要
- **推奨**: 50社以下で快適に動作

---

## 💰 コスト試算

### 1. OpenAI APIコスト（主要コスト）

#### 使用モデル
- **gpt-4o**: 15個のAI機能すべてで使用
- **gpt-4o-mini**: 一部の機能で使用（バックエンド）

#### OpenAI API価格（2024年12月時点）
- **gpt-4o**: 
  - Input: $2.50 / 1M tokens
  - Output: $10.00 / 1M tokens
- **gpt-4o-mini**:
  - Input: $0.15 / 1M tokens
  - Output: $0.60 / 1M tokens

#### 各機能のトークン使用量（推定）

| 機能名 | モデル | Input推定 | Output推定 | 1回あたりコスト |
|--------|--------|-----------|------------|----------------|
| AI分析レポート | gpt-4o | 1,500 tokens | 1,200 tokens | $0.015 |
| ファネル分析 | gpt-4o | 800 tokens | 600 tokens | $0.008 |
| スマートレポート生成 | gpt-4o | 2,000 tokens | 1,500 tokens | $0.020 |
| 広告コピー生成 | gpt-4o | 500 tokens | 400 tokens | $0.005 |
| クリエイティブ診断 | gpt-4o | 1,200 tokens | 800 tokens | $0.011 |
| 異常検知 | gpt-4o | 1,000 tokens | 700 tokens | $0.009 |
| ペルソナ生成 | gpt-4o | 600 tokens | 500 tokens | $0.006 |
| キーワード提案 | gpt-4o | 400 tokens | 300 tokens | $0.004 |
| 競合リサーチ | gpt-4o | 1,500 tokens | 1,200 tokens | $0.015 |
| LP分析 | gpt-4o | 1,000 tokens | 800 tokens | $0.009 |
| ポリシーチェック | gpt-4o | 800 tokens | 600 tokens | $0.008 |
| ABテスト判定 | gpt-4o | 600 tokens | 500 tokens | $0.006 |
| 予算最適化 | gpt-4o | 700 tokens | 600 tokens | $0.007 |
| 利益シミュレーター | gpt-4o | 500 tokens | 400 tokens | $0.005 |
| ジャーニーマップ | gpt-4o | 1,200 tokens | 1,000 tokens | $0.011 |

**平均**: 約1回あたり **$0.009** (約1.35円)

#### 月間コスト試算（使用頻度別）

| 使用パターン | AI分析回数/月 | 月間コスト（USD） | 月間コスト（円）* |
|-------------|--------------|------------------|------------------|
| 軽量利用 | 50回 | $0.45 | 約68円 |
| 標準利用 | 200回 | $1.80 | 約270円 |
| 積極利用 | 500回 | $4.50 | 約675円 |
| ヘビー利用 | 1,000回 | $9.00 | 約1,350円 |
| エンタープライズ | 5,000回 | $45.00 | 約6,750円 |

*1 USD = 150円で計算

### 2. データベースコスト

#### PostgreSQL（推奨）

| 規模 | データ量 | 推奨プラン | 月額コスト |
|------|----------|-----------|-----------|
| 小規模 | 10GB以下 | ローカル/小規模VPS | $0-20 |
| 中規模 | 50GB以下 | 中規模VPS/クラウドDB | $20-100 |
| 大規模 | 200GB以下 | 大規模VPS/マネージドDB | $100-500 |
| エンタープライズ | 200GB以上 | 専用サーバー/クラウド | $500+ |

**例**: 
- **Render PostgreSQL**: $7/月（1GB）〜 $90/月（256GB）
- **AWS RDS**: $15/月（db.t3.micro）〜 $500+/月（大規模）
- **VPS + セルフホスト**: $5-50/月

### 3. ストレージコスト

#### ファイルアップロード（CSV/Excel）

| 規模 | 月間アップロード | ストレージ必要量 | 月額コスト |
|------|----------------|----------------|-----------|
| 小規模 | 10ファイル | 100MB | $0-1 |
| 中規模 | 50ファイル | 500MB | $1-5 |
| 大規模 | 200ファイル | 2GB | $5-20 |
| エンタープライズ | 1,000ファイル | 10GB | $20-100 |

**例**:
- **AWS S3**: $0.023/GB/月
- **ローカルストレージ**: $0（VPS内）

### 4. サーバー・インフラコスト

#### バックエンド + フロントエンド

| 規模 | 推奨構成 | 月額コスト |
|------|----------|-----------|
| 小規模 | 1 VPS (2GB RAM) | $5-10 |
| 中規模 | 1 VPS (4GB RAM) | $10-20 |
| 大規模 | 2 VPS (4GB + 2GB) | $20-40 |
| エンタープライズ | ロードバランサー + 複数サーバー | $100+ |

**例**:
- **Render**: $7/月（バックエンド）+ $7/月（フロントエンド）= $14/月
- **DigitalOcean**: $6/月（Basic Droplet）
- **AWS EC2**: $10-50/月（t3.small）

### 5. その他コスト

- **ドメイン**: $10-15/年（約$1/月）
- **SSL証明書**: $0（Let's Encrypt無料）
- **監視・ログ**: $0-20/月（オプション）
- **バックアップ**: $0-10/月（オプション）

---

## 📈 総コスト試算（月額）

### シナリオ別

#### シナリオ1: 小規模運用（10社、軽量利用）
- OpenAI API: **$0.45** (約68円)
- データベース: **$7** (Render PostgreSQL)
- ストレージ: **$0.50** (S3 20GB)
- サーバー: **$14** (Render)
- **合計: 約$22/月（約3,300円/月）**

#### シナリオ2: 中規模運用（50社、標準利用）
- OpenAI API: **$1.80** (約270円)
- データベース: **$20** (中規模VPS)
- ストレージ: **$2** (S3 100GB)
- サーバー: **$20** (VPS)
- **合計: 約$44/月（約6,600円/月）**

#### シナリオ3: 大規模運用（200社、積極利用）
- OpenAI API: **$4.50** (約675円)
- データベース: **$100** (大規模VPS/マネージドDB)
- ストレージ: **$10** (S3 500GB)
- サーバー: **$40** (複数VPS)
- **合計: 約$155/月（約23,250円/月）**

#### シナリオ4: エンタープライズ（500社、ヘビー利用）
- OpenAI API: **$9.00** (約1,350円)
- データベース: **$500** (専用サーバー/クラウド)
- ストレージ: **$50** (S3 2TB)
- サーバー: **$200** (ロードバランサー + 複数サーバー)
- **合計: 約$759/月（約113,850円/月）**

---

## 💡 コスト最適化の提案

### 1. OpenAI APIコスト削減

- **gpt-4o-miniの活用**: 一部の機能でgpt-4o-miniを使用（コスト1/10）
- **キャッシング**: 同じデータの再分析を避ける
- **バッチ処理**: 複数の分析をまとめて実行
- **使用頻度制限**: プランに応じた制限を実装

### 2. インフラコスト削減

- **VPSの活用**: マネージドサービスより安価
- **ストレージ最適化**: 古いデータのアーカイブ
- **CDNの活用**: 静的ファイルの配信コスト削減

### 3. プラン別制限の実装（推奨）

| プラン | 会社数制限 | AI分析回数/月 | データ保存期間 |
|--------|-----------|--------------|---------------|
| FREE | 3社 | 3回 | 30日 |
| PRO | 50社 | 100回 | 1年 |
| BUSINESS | 無制限 | 1,000回 | 無制限 |

---

## 📝 注意事項

1. **為替レート**: 1 USD = 150円で計算（変動あり）
2. **OpenAI価格**: 2024年12月時点の価格（変更の可能性あり）
3. **使用頻度**: 実際の使用状況により変動
4. **スケーリング**: 規模に応じてコストは線形に増加

---

## 🎯 推奨事項

1. **初期段階**: 小規模運用から開始（$20-30/月）
2. **成長段階**: 使用量に応じて段階的にスケールアップ
3. **コスト監視**: 月次でコストを確認し、最適化
4. **プラン制限**: ユーザーごとの使用量制限を実装

